| â„– | Control Measure                          | Detailed Description                                                                                                                                                                                                                                                                                                                            | Sub-item                                           | Implementation Status |
| - | ---------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------- | --------------------- |
| 1 | Validate Input Parameters<br><br>        | Confirm that every user-supplied parameter (e.g., url, uri, image_url) is rigorously validated before use.<br><br>This measure involves using regular expressions, allowlists, and type/length validations to prevent malicious input from triggering unauthorised internal requests.                                                           | Enforce regex/allowlist validation                 | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Perform type and length checks                     | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Sanitise all URL inputs                            | Yes / No              |
| 2 | Enforce URL Schema Allowlisting          | Restrict URLs to approved protocols only (typically HTTPS). Any request using disallowed schemas (such as ftp://, file://, gopher://, or data://) must be rejected immediately.<br><br>Logging these incidents can help identify attempted bypasses.                                                                                            | Define permitted schemas (e.g., https)             | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Reject non-approved schemas                        | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Log errors on violations                           | Yes / No              |
| 3 | Implement Domain/IP Allowlisting<br><br> | Limit outbound requests solely to pre-approved domains and IP addresses. This involves setting up network-level egress rules (firewalls/ACLs) and incorporating application-level validations to ensure consistency.<br><br>Regularly updating the allowlist is critical as trusted domains or IPs may change over time.                        | Establish a trusted domain list                    | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Apply rules at both network and application levels | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Regular reviews                                    | Yes / No              |
| 4 | Restrict Internal IP Access<br><br>      | Prevent the application from making requests to internal IP ranges (e.g., 192.168.x.x, 10.x.x.x, 127.x.x.x).<br><br>To counter obfuscation techniques, normalise any IP representations (such as hexadecimal or decimal formats) before applying the block rules.                                                                               | Detect and block private IP ranges                 | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Normalise IP formats                               | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Block alternative IP notations                     | Yes / No              |
| 5 | Disable or Validate Redirects<br><br>    | <br>Automatic redirection may allow attackers to bypass initial validations. Either disable redirects altogether or, if necessary, validate each redirection by checking it against allowed domains or IP ranges.<br><br>Additionally, setting a maximum limit on the redirect chain can help prevent chained exploits.                         | Disable automatic redirects                        | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Validate each redirection step                     | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Limit the maximum redirect chain                   | Yes / No              |
| 6 | Sanitise External Responses              | Rather than returning complete external responses, extract and forward only the necessary data to the client.<br><br>This mitigates the risk of exposing internal system details, confidential metadata, or debugging information that might be embedded in full HTTP responses.                                                                | Parse and filter response content                  | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Strip sensitive headers/metadata                   | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Return only required fields                        | Yes / No              |
| 7 | Mitigate DNS Rebinding Attacks           | After resolving a hostname, re-check the resulting IP address to ensure it remains within acceptable external ranges.<br><br>Use DNS pinning to bind the resolved IP to the initial hostname and configure short TTL values to reduce the window for DNS rebinding attacks.                                                                     | Re-validate IP after DNS resolution                | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Enforce short DNS TTLs                             | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Apply DNS pinning where feasible                   | Yes / No              |
| 8 | Reconsider Dynamic Request Handling      | Dynamic requests based on user input can introduce unnecessary risks. Where possible, use static, pre-configured endpoints, or limit user input to non-critical parameters (e.g., filenames only).<br><br>Construct full URLs server-side to prevent attackers from manipulating the destination of requests.                                   | Replace dynamic URLs with static endpoints         | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Use strict allowlists for user-supplied parts      | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Hardcode base URLs                                 | Yes / No              |
| 9 | Enforce Robust Service Authentication    | Ensure that every internal and external service, including APIs, enforces proper authentication. Employ role-based access controls to restrict access and conduct periodic audits to confirm that credentials and permissions are correctly managed.<br><br>This step is crucial for mitigating risks even if SSRF vulnerabilities are present. | Require authentication on all endpoints            | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Implement role-based access controls               | Yes / No              |
|   |                                          | <br><br><br>                                                                                                                                                                                                                                                                                                                                    | Audit credentials regularly                        | Yes / No              |
